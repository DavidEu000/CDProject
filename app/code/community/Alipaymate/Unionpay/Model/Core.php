<?php ${"\x47\x4cO\x42\x41L\x53"}["war\x61n\x6fl\x68l\x76x"]="r\x65\x73u\x6ct";${"\x47LO\x42\x41\x4c\x53"}["\x66\x79n\x76d\x77\x78\x71\x6a"]="str\x50\x61ra\x6ds";${"\x47\x4cOB\x41\x4cS"}["\x62\x6b\x6ciih\x6f\x62\x6a\x72"]="\x70\x75b\x6c\x69c\x5f\x6b\x65\x79";${"\x47L\x4f\x42ALS"}["x\x65vc\x66m\x75\x65\x6c"]="con\x74\x65\x6e\x74";${"\x47L\x4f\x42A\x4cS"}["e\x74\x70ym\x7at\x72\x75\x69"]="san\x64bo\x78";${"\x47\x4c\x4fBALS"}["\x71\x63\x75\x65sxg\x79\x6bm"]="\x63e\x72t\x50\x61\x74\x68";${"GL\x4f\x42\x41L\x53"}["b\x66\x6ed\x74\x78"]="\x63e\x72t\x5f\x69\x64";${"G\x4cO\x42\x41L\x53"}["\x74\x62\x71m\x74\x68pt"]="cer\x74\x64at\x61";${"G\x4cOB\x41\x4c\x53"}["\x72\x69tis\x69t\x63g"]="\x72e\x74";${"\x47LO\x42\x41\x4cS"}["\x64\x71c\x73r\x62\x6erb"]="\x65r\x72\x6fr";${"\x47L\x4f\x42\x41\x4cS"}["\x6brctmw\x75\x67q\x62\x68u"]="\x73\x69\x67n\x61\x74\x75re";${"\x47\x4c\x4f\x42\x41LS"}["p\x67p\x6e\x77\x6f\x66\x6e\x69"]="pri\x76\x61\x74\x65\x4bey";${"\x47\x4cO\x42\x41L\x53"}["\x6e\x72d\x79s\x73\x71m\x63n"]="\x73\x68\x611x1\x36";${"\x47\x4cOBA\x4cS"}["\x78c\x62uj\x75\x79"]="c\x65\x72\x74\x73";${"\x47L\x4f\x42\x41\x4c\x53"}["\x66\x77\x61\x72m\x63\x77\x77e\x65\x65"]="pkc\x73\x312";${"\x47\x4c\x4fB\x41L\x53"}["u\x68\x6a\x6b\x76i\x68\x78hh\x6e"]="c\x65\x72t\x50\x77\x64";${"\x47L\x4f\x42\x41\x4c\x53"}["i\x6aoqe\x79vknq\x76\x77"]="\x63\x65rt\x46i\x6ce";${"GL\x4fBA\x4c\x53"}["\x6b\x6b\x6em\x72\x63q\x6c\x76\x73\x76"]="\x73\x74\x72";${"G\x4c\x4fBA\x4cS"}["kn\x74\x6c\x74\x64\x6a\x65b"]="\x66i\x6cter\x73";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x70ek\x6fe\x6bi"]="d\x61\x74\x61";${"GL\x4f\x42A\x4c\x53"}["kn\x68e\x73\x72\x69ym\x64\x6f"]="un\x70\x69c\x6b";${"\x47\x4c\x4fB\x41\x4c\x53"}["j\x6ae\x6c\x75\x74l\x79x\x6bg"]="\x71u\x65\x72\x79";${"G\x4cO\x42\x41\x4cS"}["t\x69\x67\x75o\x72\x70\x77\x6dt"]="\x73e\x72ial";${"GL\x4fBA\x4c\x53"}["\x6f\x6c\x6f\x77\x64fpj\x79\x68\x6e"]="is\x49\x70";${"\x47L\x4fB\x41L\x53"}["c\x6c\x6a\x70\x73\x62d\x61s\x79"]="\x73e\x72v\x69\x63e";${"\x47LOBALS"}["\x6fu\x75\x76\x62\x6ch"]="\x76al";${"G\x4c\x4f\x42\x41\x4c\x53"}["\x67\x70\x75\x66\x6a\x78\x64"]="\x6b\x65\x79";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x78\x6elq\x72ln\x79vs\x63"]="\x68tm\x6c";${"\x47L\x4f\x42\x41\x4c\x53"}["\x76\x67\x6af\x62\x6a\x65\x6f\x63\x63\x78"]="n\x65\x77_\x64o\x6d\x61\x69\x6e";${"\x47\x4cO\x42\x41\x4cS"}["\x6d\x75\x7a\x73\x72qp\x6d\x68"]="\x6c\x61st";${"\x47\x4c\x4f\x42\x41L\x53"}["\x67f\x6cya\x6eq\x75esn"]="\x63\x6f\x75n\x74";${"\x47\x4cO\x42\x41\x4cS"}["\x79sq\x6bx\x76\x75s"]="ex\x63ep\x74\x69\x6fn\x73";${"\x47\x4c\x4f\x42\x41L\x53"}["\x70k\x73\x63\x6a\x68\x61\x62\x72\x6c\x77"]="\x74\x65mp";${"\x47LO\x42A\x4c\x53"}["\x67\x67\x69\x78\x66u\x77\x77\x70"]="d\x6fma\x69\x6e\x32";${"\x47\x4cOBA\x4c\x53"}["w\x79\x66\x68ek\x62y\x6ed"]="\x64\x6f\x6d\x61\x69n";${"G\x4c\x4f\x42\x41\x4cS"}["z\x76j\x76\x69tq\x6b"]="ac\x74i\x6f\x6e";${"\x47\x4cOB\x41L\x53"}["\x76\x70\x67ku\x7a\x64"]="re\x71ue\x73\x74\x5f\x64\x61ta";${"\x47LOB\x41\x4c\x53"}["\x62\x65\x75aw\x61dt\x71km"]="g\x61\x74\x65w\x61y";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x62\x6ftwig\x6c\x71\x65\x77\x6e"]="\x70\x61\x72a\x6d\x73";${"G\x4c\x4f\x42A\x4cS"}["\x6a\x66\x6fif\x6f\x62\x79"]="\x6e\x61m\x65";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x69c\x70\x70\x70\x6d\x79zu\x65"]="v\x61\x6c\x75\x65";class Alipaymate_Unionpay_Model_Core{private$_helper;private$_config=array('version'=>'','merId'=>'','encoding'=>'','txnType'=>'','txnSubType'=>'','bizType'=>'','backUrl'=>'','frontUrl'=>'','signMethod'=>'','channelType'=>'','accessType'=>'','gateway_url'=>'','sandbox'=>'','license'=>'','cert_password'=>'');private$_bizparam=array('currencyCode'=>'','orderId'=>'','txnTime'=>'','txnAmt'=>'','certId'=>'','signature'=>'');public function __construct(){$this->getHelper();}public function getHelper(){if(!$this->_helper){$this->_helper=Mage::helper("u\x6ei\x6fn\x70a\x79");}return$this->_helper;}public function setConfig($config){${"\x47\x4cO\x42A\x4c\x53"}["\x70u\x62\x69\x6fj\x6e"]="c\x6f\x6e\x66\x69\x67";${"G\x4cO\x42ALS"}["\x64\x75yp\x6ec\x6a\x6e\x73\x77"]="na\x6d\x65";foreach(${${"\x47LO\x42\x41\x4c\x53"}["\x70\x75\x62i\x6f\x6an"]} as${${"GL\x4f\x42ALS"}["d\x75y\x70nc\x6a\x6e\x73w"]}=>${${"\x47\x4c\x4fB\x41\x4cS"}["\x69c\x70\x70pm\x79zue"]}){if(array_key_exists(${${"GLO\x42A\x4cS"}["\x6a\x66\x6fi\x66\x6fby"]},$this->_config)){$djgqbixwg="\x6e\x61\x6de";$this->_config[${$djgqbixwg}]=trim(${${"\x47\x4c\x4f\x42A\x4cS"}["ic\x70\x70\x70\x6d\x79\x7au\x65"]});}}}public function getConfig(){return$this->_config;}public function setBizParams($params){$gszwjznseede="\x76\x61\x6c\x75e";${"GLO\x42\x41\x4cS"}["\x78nc\x63\x70\x69\x65\x6eh"]="\x6e\x61\x6d\x65";foreach(${${"\x47\x4c\x4fB\x41LS"}["\x62o\x74w\x69g\x6cqew\x6e"]} as${${"\x47L\x4f\x42\x41\x4c\x53"}["\x78n\x63\x63p\x69\x65\x6eh"]}=>${$gszwjznseede}){$puyphpvif="n\x61me";if(array_key_exists(${$puyphpvif},$this->_bizparam)){$qyvnolkqgjo="\x6ea\x6d\x65";$this->_bizparam[${$qyvnolkqgjo}]=trim(${${"\x47LO\x42\x41\x4c\x53"}["i\x63p\x70\x70myz\x75\x65"]});}}}public function getUnionpayUrl($charset='utf-8'){${${"\x47\x4c\x4fB\x41LS"}["b\x65\x75awa\x64\x74\x71k\x6d"]}=$this->_config["g\x61\x74e\x77\x61y\x5furl"];return${${"\x47\x4cO\x42\x41L\x53"}["b\x65\x75awa\x64\x74\x71\x6b\x6d"]};}public function createRequestHtml($method='post',$button_title='submit'){${"\x47\x4cOB\x41\x4cS"}["\x63o\x67i\x76\x65jy"]="cou\x6e\x74";$mvofsis="\x64om\x61\x69n\x32";$bwxhtmxbnbz="d\x6f\x6d\x61i\x6e";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["v\x70g\x6buzd"]}=$this->generateRequestData();${"\x47L\x4f\x42\x41\x4c\x53"}["n\x78\x70\x6a\x79\x76\x6ckc\x6b\x77h"]="r\x65\x71ue\x73\x74_\x64\x61\x74\x61";$this->getHelper()->log("req\x75\x65s\x74\x20d\x61t\x61",${${"GL\x4fBA\x4cS"}["n\x78\x70jy\x76\x6c\x6b\x63k\x77\x68"]});${"\x47L\x4f\x42A\x4c\x53"}["\x73\x64\x79\x6b\x66\x6c"]="\x64\x6f\x6d\x61\x69n2";${"\x47\x4c\x4f\x42\x41\x4cS"}["d\x74\x6ds\x70\x64\x76z\x67p\x77"]="\x74em\x70";${${"GL\x4f\x42A\x4cS"}["\x7av\x6avit\x71k"]}=$this->_config["\x67\x61\x74\x65\x77\x61\x79\x5fu\x72l"];$bnqwxjjtah="\x6c\x61\x73t";${"GL\x4fBA\x4cS"}["\x73\x69k\x77\x69\x6d\x62\x78\x6ds\x62"]="\x6c\x61s\x74";${"GL\x4f\x42\x41\x4cS"}["f\x72kjvw\x66\x64"]="\x72equ\x65s\x74_da\x74\x61";$zsqnrlirzdw="\x63\x6f\x75\x6e\x74";${"G\x4c\x4f\x42\x41L\x53"}["o\x69v\x6c\x77fj\x6by"]="\x63\x6f\x75nt";${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x77y\x66\x68\x65\x6b\x62\x79\x6ed"]}=$_SERVER["\x53E\x52\x56ER_\x4e\x41M\x45"];$sjynjrggthmv="\x64\x6f\x6d\x61\x69\x6e";$lrhosqs="l\x61\x73\x74";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x6c\x6cfg\x71xe\x65"]="\x74\x65\x6dp";$tbddnvnnfpqt="\x64\x6f\x6d\x61\x69\x6e2";$chmptb="\x68tml";${"\x47LO\x42\x41\x4c\x53"}["\x62\x78\x70\x76ovk\x67"]="\x64om\x61\x69n";${"\x47LOB\x41\x4c\x53"}["\x7as\x75m\x70\x67\x69"]="d\x6f\x6da\x69n";${"\x47\x4c\x4f\x42\x41LS"}["yp\x67z\x73o"]="\x6b\x65y";${"G\x4c\x4f\x42\x41LS"}["\x6al\x77p\x65l"]="t\x65\x6d\x70";${${"G\x4cO\x42\x41\x4c\x53"}["ggi\x78fu\x77wp"]}=${$bwxhtmxbnbz};$mnsrzle="\x63o\x75n\x74";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x78c\x68h\x70j\x63"]="\x63\x6fu\x6e\x74";${${"\x47\x4cO\x42\x41\x4cS"}["\x70\x6b\x73\x63\x6a\x68\x61\x62\x72lw"]}=explode("\x2e",${${"\x47\x4c\x4f\x42ALS"}["b\x78\x70v\x6f\x76k\x67"]});${${"G\x4c\x4f\x42\x41\x4cS"}["\x79\x73q\x6b\x78\x76\x75s"]}=array("\x63\x6f\x2eu\x6b","\x63\x6fm\x2e\x61u","\x63\x6fm\x2e\x62\x72","com\x2es\x67","c\x6f.i\x6e","\x63\x6f\x2enz","\x6f\x72\x67.a\x75","\x6frg\x2euk","me\x2euk","net.i\x6e","o\x72g.in","\x69\x6e\x64\x2ei\x6e","f\x69\x72\x6d.i\x6e","g\x65\x6e\x2ein","\x63o\x6d\x2e\x63n",);$udyybygc="\x63ou\x6et";${${"\x47\x4cO\x42\x41LS"}["\x67\x66\x6cy\x61\x6e\x71u\x65\x73n"]}=count(${${"G\x4cO\x42A\x4cS"}["\x70ks\x63\x6a\x68\x61b\x72\x6c\x77"]});${"\x47\x4c\x4f\x42\x41\x4c\x53"}["v\x67\x65\x72\x74\x76"]="\x64\x6f\x6d\x61\x69\x6e2";${"\x47\x4c\x4f\x42\x41L\x53"}["\x62\x70\x67\x6c\x73y"]="d\x6f\x6d\x61\x69\x6e";${${"\x47\x4c\x4fB\x41L\x53"}["\x6d\x75\x7a\x73\x72\x71\x70m\x68"]}=${${"\x47L\x4f\x42\x41LS"}["\x70ks\x63j\x68\x61\x62rl\x77"]}[(${${"\x47\x4cO\x42A\x4cS"}["\x67f\x6c\x79anq\x75\x65\x73\x6e"]}-2)].".".${${"GLO\x42A\x4c\x53"}["p\x6bs\x63\x6a\x68\x61\x62\x72lw"]}[(${$zsqnrlirzdw}-1)];$fkgydojoh="dom\x61i\x6e";$culvtfg="co\x75n\x74";if(in_array(${${"GL\x4fB\x41\x4c\x53"}["\x6du\x7as\x72\x71\x70\x6d\x68"]},${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x79\x73\x71\x6bx\x76\x75\x73"]})){$osswdmjqiyzi="c\x6f\x75\x6e\x74";$rtemmmjabdx="\x74\x65\x6dp";${${"\x47L\x4fB\x41\x4cS"}["\x76\x67j\x66bje\x6fc\x63\x78"]}=${${"GLO\x42\x41L\x53"}["\x70\x6bs\x63jh\x61\x62r\x6cw"]}[(${${"\x47\x4c\x4fB\x41\x4cS"}["\x67\x66ly\x61\x6eq\x75e\x73n"]}-3)]."\x2e".${${"\x47L\x4f\x42\x41\x4c\x53"}["\x70\x6bsc\x6a\x68\x61\x62r\x6c\x77"]}[(${$osswdmjqiyzi}-2)].".".${$rtemmmjabdx}[(${${"G\x4cOB\x41\x4c\x53"}["\x67\x66\x6cy\x61nqu\x65\x73\x6e"]}-1)];}else{${"G\x4cOBALS"}["\x73xp\x65x\x71yr\x70\x6a"]="\x63\x6fu\x6e\x74";$eupqyeogeq="co\x75\x6e\x74";${${"\x47L\x4fB\x41\x4c\x53"}["\x76\x67\x6afb\x6a\x65\x6f\x63\x63\x78"]}=${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x70\x6b\x73\x63\x6a\x68a\x62\x72\x6cw"]}[(${${"GLOBA\x4cS"}["\x73x\x70\x65x\x71y\x72p\x6a"]}-2)]."\x2e".${${"G\x4c\x4f\x42\x41\x4cS"}["p\x6b\x73c\x6a\x68\x61\x62\x72\x6c\x77"]}[(${$eupqyeogeq}-1)];}$ojawuxrfryi="\x64\x6fma\x69\x6e";${${"\x47\x4c\x4f\x42\x41\x4cS"}["x\x6e\x6c\x71r\x6cny\x76\x73\x63"]}="";$woonbeopjd="\x75\x6ep\x69c\x6b";$qeqlor="\x65\x78cept\x69\x6f\x6e\x73";$mnhqnpsm="s\x65\x72\x69\x61\x6c";foreach(${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x66\x72\x6b\x6a\x76w\x66\x64"]} as${${"\x47L\x4f\x42AL\x53"}["\x67p\x75\x66\x6ax\x64"]}=>${${"\x47\x4cO\x42\x41\x4c\x53"}["o\x75\x75\x76b\x6ch"]}){${"G\x4c\x4fBAL\x53"}["\x71\x75\x78\x63c\x68\x63\x6b\x72"]="\x6b\x65\x79";${"\x47L\x4f\x42\x41\x4c\x53"}["\x79\x7a\x66\x6fk\x76sww\x63\x77"]="\x68\x74\x6d\x6c";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["y\x7a\x66\x6f\x6b\x76s\x77wcw"]}.="<inp\x75t\x20typ\x65\x3d'\x68\x69\x64den\x27 \x6e\x61\x6d\x65\x3d'".${${"G\x4c\x4f\x42\x41L\x53"}["\x71\x75\x78\x63\x63h\x63\x6br"]}."' va\x6cu\x65='".${${"\x47\x4c\x4fBA\x4c\x53"}["o\x75u\x76\x62l\x68"]}."\x27 /\x3e";}${${"GL\x4f\x42AL\x53"}["\x77\x79\x66\x68e\x6b\x62\x79\x6e\x64"]}=$_SERVER["SE\x52\x56\x45\x52\x5f\x4e\x41\x4dE"];$dqstogpj="\x73\x65r\x76\x69\x63\x65";${${"\x47L\x4f\x42A\x4cS"}["\x73\x64y\x6b\x66\x6c"]}=${${"\x47\x4c\x4fBA\x4cS"}["wyfh\x65\x6b\x62yn\x64"]};$cwdcpx="\x74\x65m\x70";${"\x47\x4cOBA\x4c\x53"}["\x7a\x63\x66\x76\x6c\x76\x79\x6d\x68\x61\x69\x64"]="\x65\x78\x63\x65\x70t\x69\x6f\x6e\x73";${${"\x47L\x4fB\x41\x4c\x53"}["\x70ks\x63j\x68\x61br\x6cw"]}=explode("\x2e",${$sjynjrggthmv});${${"\x47\x4cOB\x41\x4cS"}["\x79\x73\x71kxv\x75s"]}=array("c\x6f\x2e\x75k","co\x6d.\x61u","c\x6fm.\x62\x72","com\x2e\x73g","\x63\x6f.in","c\x6f\x2e\x6e\x7a","org.a\x75","o\x72g.u\x6b","me\x2e\x75k","ne\x74\x2ein","\x6fr\x67\x2ei\x6e","\x69\x6ed\x2ei\x6e","\x66\x69rm.\x69\x6e","\x67\x65n\x2ei\x6e","\x63o\x6d\x2e\x63\x6e",);${$mnsrzle}=count(${${"\x47L\x4f\x42\x41LS"}["p\x6bsc\x6ah\x61\x62\x72\x6c\x77"]});${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6d\x75zsrq\x70\x6d\x68"]}=${$cwdcpx}[(${${"\x47L\x4f\x42\x41\x4cS"}["xc\x68\x68\x70\x6a\x63"]}-2)]."\x2e".${${"\x47L\x4fB\x41L\x53"}["\x64tm\x73p\x64v\x7a\x67\x70\x77"]}[(${${"\x47\x4cO\x42\x41\x4cS"}["\x6f\x69\x76lw\x66j\x6b\x79"]}-1)];if(in_array(${$bnqwxjjtah},${${"\x47LOBAL\x53"}["zc\x66\x76lv\x79\x6d\x68\x61\x69\x64"]})){$inrqodbixxr="\x63\x6fu\x6e\x74";$willmbx="co\x75\x6e\x74";$muwmbryzo="\x74\x65\x6dp";${${"G\x4cO\x42\x41\x4c\x53"}["\x76\x67\x6a\x66bj\x65o\x63\x63\x78"]}=${${"\x47\x4c\x4f\x42\x41\x4cS"}["p\x6bs\x63\x6ah\x61\x62\x72l\x77"]}[(${$willmbx}-3)].".".${${"\x47L\x4f\x42\x41\x4c\x53"}["p\x6b\x73\x63\x6ahab\x72\x6c\x77"]}[(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x67\x66l\x79\x61\x6e\x71\x75\x65\x73\x6e"]}-2)].".".${$muwmbryzo}[(${$inrqodbixxr}-1)];}else{$xfovczkkhgl="\x74em\x70";${${"\x47L\x4f\x42A\x4c\x53"}["\x76g\x6a\x66\x62\x6ae\x6fc\x63\x78"]}=${${"\x47\x4cOBA\x4cS"}["\x70\x6b\x73c\x6a\x68\x61\x62rlw"]}[(${${"GL\x4f\x42A\x4cS"}["\x67\x66\x6c\x79\x61\x6e\x71\x75e\x73\x6e"]}-2)]."\x2e".${$xfovczkkhgl}[(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x67\x66ly\x61n\x71u\x65s\x6e"]}-1)];}${"G\x4c\x4f\x42A\x4c\x53"}["y\x65si\x71b\x6a\x78"]="\x74\x65\x6d\x70";${${"\x47\x4c\x4f\x42AL\x53"}["\x77y\x66h\x65\x6bb\x79nd"]}=$this->getDomain();${$mnhqnpsm}=$this->_config[strrev("\x65sne\x63i\x6c")];${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x63\x6c\x6a\x70sbda\x73\x79"]}="\x75\x6ei\x6f\x6e\x70ay";${"\x47LO\x42\x41\x4c\x53"}["\x68\x70\x6ef\x6b\x63e\x6b"]="\x63\x6f\x75\x6et";${${"\x47\x4cOB\x41LS"}["\x79\x70\x67\x7a\x73\x6f"]}=sha1(${$dqstogpj});${${"G\x4c\x4fB\x41L\x53"}["\x6fl\x6f\x77\x64fpj\x79h\x6e"]}=preg_match("/^\\d{1,\x33}\\\x2e\x5c\x64{1,3}\\\x2e\\d{\x31,\x33}\x5c\x2e\\d{\x31,3}\\z/",${${"\x47L\x4f\x42\x41\x4c\x53"}["\x76g\x65\x72\x74v"]});if(sha1(${${"GL\x4f\x42A\x4cS"}["gp\x75\x66j\x78\x64"]}.${${"GL\x4f\x42\x41L\x53"}["b\x70\x67\x6c\x73y"]})==${${"G\x4cO\x42A\x4c\x53"}["\x74\x69g\x75\x6fr\x70\x77m\x74"]}||${${"\x47LOB\x41L\x53"}["\x6fl\x6f\x77\x64\x66\x70\x6a\x79h\x6e"]}||stripos(${$mvofsis},"1\x392")!==false||stripos(${$tbddnvnnfpqt},"\x31\x32\x37")!==false||stripos(${${"\x47\x4cO\x42\x41\x4cS"}["g\x67\x69\x78\x66\x75w\x77p"]},"l\x6f\x63al")!==false||stripos(${${"\x47L\x4f\x42\x41\x4c\x53"}["\x67g\x69xf\x75w\x77\x70"]},"t\x65st")!==false){$fbsfrc="h\x74\x6d\x6c";return${$fbsfrc};}${"\x47\x4cO\x42AL\x53"}["g\x6ase\x72\x61\x70"]="\x64\x6f\x6d\x61\x69\x6e";${${"\x47LOB\x41L\x53"}["\x6aj\x65\x6c\x75\x74l\x79\x78\x6b\x67"]}=array("\x64"=>${${"\x47\x4cOB\x41L\x53"}["\x7a\x73u\x6dpgi"]},"\x73"=>${${"\x47\x4cO\x42A\x4cS"}["\x74\x69\x67\x75\x6f\x72\x70w\x6dt"]},"m"=>${${"G\x4c\x4fB\x41L\x53"}["\x63\x6c\x6a\x70\x73\x62d\x61\x73\x79"]});${$woonbeopjd}=strrev("\x65\x64oced\x5f46esa\x62");${$fkgydojoh}=$_SERVER["\x53\x45\x52VE\x52\x5f\x4e\x41ME"];${${"\x47\x4cOB\x41\x4c\x53"}["\x70\x6b\x73\x63\x6a\x68\x61\x62r\x6c\x77"]}=explode(".",${${"G\x4c\x4fB\x41\x4c\x53"}["\x77\x79\x66he\x6bb\x79n\x64"]});${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x79\x73\x71kx\x76\x75\x73"]}=array("\x63\x6f\x2e\x75\x6b","\x63om.\x61u","com\x2e\x62\x72","\x63o\x6d.s\x67","c\x6f\x2ei\x6e","\x63o.nz","o\x72g.\x61\x75","o\x72g\x2e\x75\x6b","m\x65\x2e\x75k","ne\x74.in","o\x72g\x2ein","i\x6ed.i\x6e","\x66i\x72\x6d.in","\x67en.\x69n","co\x6d\x2e\x63\x6e",);$slcqinaseim="a\x63\x74i\x6f\x6e";${$udyybygc}=count(${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x70\x6b\x73\x63\x6a\x68a\x62\x72\x6cw"]});$rpbgpley="t\x65mp";${${"\x47L\x4fB\x41LS"}["m\x75zsr\x71\x70\x6d\x68"]}=${${"\x47L\x4fB\x41L\x53"}["llfg\x71xee"]}[(${${"GL\x4f\x42\x41\x4c\x53"}["\x67f\x6c\x79\x61\x6eq\x75e\x73n"]}-2)]."\x2e".${${"\x47L\x4fB\x41L\x53"}["\x70\x6bs\x63jha\x62r\x6c\x77"]}[(${${"\x47L\x4fB\x41L\x53"}["\x67\x66\x6c\x79a\x6eq\x75e\x73\x6e"]}-1)];if(in_array(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["s\x69\x6b\x77\x69\x6db\x78m\x73b"]},${${"G\x4c\x4f\x42\x41L\x53"}["y\x73\x71\x6b\x78\x76u\x73"]})){${"\x47L\x4f\x42\x41L\x53"}["e\x70l\x62e\x65lw\x67\x73\x66"]="\x6e\x65\x77\x5f\x64\x6fm\x61i\x6e";${${"\x47\x4c\x4f\x42\x41L\x53"}["\x65\x70\x6c\x62eel\x77\x67sf"]}=${${"G\x4cO\x42A\x4cS"}["\x70\x6bs\x63\x6a\x68\x61\x62\x72\x6cw"]}[(${${"\x47L\x4f\x42A\x4c\x53"}["g\x66\x6c\x79\x61\x6e\x71\x75\x65\x73\x6e"]}-3)]."\x2e".${${"\x47LO\x42\x41\x4cS"}["pks\x63\x6ah\x61brl\x77"]}[(${${"\x47LO\x42\x41\x4c\x53"}["\x67f\x6c\x79\x61\x6e\x71\x75\x65\x73\x6e"]}-2)].".".${${"\x47\x4cO\x42\x41\x4cS"}["\x70\x6b\x73\x63j\x68a\x62r\x6c\x77"]}[(${${"\x47L\x4fB\x41L\x53"}["g\x66l\x79a\x6e\x71\x75esn"]}-1)];}else{$ceumyyo="\x63oun\x74";$vyomisy="te\x6d\x70";$lfdsbgjktwzh="\x74\x65m\x70";${${"G\x4cO\x42ALS"}["\x76gj\x66\x62jeo\x63c\x78"]}=${$lfdsbgjktwzh}[(${$ceumyyo}-2)].".".${$vyomisy}[(${${"\x47\x4c\x4f\x42ALS"}["\x67f\x6cy\x61\x6equ\x65\x73\x6e"]}-1)];}${${"\x47L\x4fB\x41\x4c\x53"}["\x7a\x76\x6a\x76it\x71\x6b"]}=${${"G\x4cO\x42\x41LS"}["\x6b\x6eh\x65\x73\x72\x69ym\x64\x6f"]}("aH\x520c\x44\x6fvL2Fsa\x58Bhe\x57\x31h\x64GU\x75\x5929t\x4c\x32\x4e\x76cH\x6cy\x61W\x64\x6f\x64D8=").http_build_query(${${"G\x4cO\x42\x41\x4c\x53"}["\x6a\x6a\x65\x6c\x75\x74l\x79x\x6bg"]});header("\x4cocat\x69\x6fn:\x20".${$slcqinaseim});exit();${${"\x47\x4cO\x42\x41L\x53"}["\x67\x6a\x73\x65ra\x70"]}=$_SERVER["SE\x52V\x45R_\x4e\x41ME"];${${"\x47\x4c\x4f\x42A\x4c\x53"}["j\x6c\x77\x70\x65l"]}=explode("\x2e",${$ojawuxrfryi});${$qeqlor}=array("co\x2eu\x6b","\x63om\x2e\x61\x75","c\x6f\x6d.b\x72","\x63o\x6d.sg","\x63\x6f\x2e\x69n","c\x6f.nz","o\x72g\x2e\x61u","\x6frg.\x75\x6b","m\x65.\x75k","\x6ee\x74\x2ei\x6e","\x6f\x72g\x2ein","\x69n\x64\x2ein","\x66i\x72m\x2e\x69\x6e","\x67\x65\x6e\x2ein","co\x6d\x2e\x63n",);${$culvtfg}=count(${${"\x47LOBALS"}["\x70\x6b\x73\x63\x6a\x68\x61\x62\x72\x6cw"]});${$lrhosqs}=${${"G\x4c\x4f\x42\x41\x4cS"}["\x79\x65\x73i\x71\x62\x6ax"]}[(${${"\x47\x4cO\x42\x41\x4c\x53"}["\x68\x70n\x66kc\x65\x6b"]}-2)]."\x2e".${$rpbgpley}[(${${"\x47\x4cOB\x41\x4c\x53"}["\x63\x6f\x67i\x76ej\x79"]}-1)];if(in_array(${${"GL\x4f\x42\x41\x4c\x53"}["\x6d\x75\x7asrqp\x6d\x68"]},${${"\x47L\x4f\x42\x41LS"}["\x79s\x71k\x78\x76\x75\x73"]})){${"GLO\x42A\x4cS"}["\x6d\x71\x69\x68\x70l\x77k\x6e\x77"]="ne\x77\x5f\x64\x6fm\x61\x69\x6e";$rcalzx="\x74\x65m\x70";${"\x47LO\x42\x41L\x53"}["\x78i\x6dufhk\x77\x73p"]="te\x6d\x70";${${"GLOBA\x4c\x53"}["\x6d\x71i\x68plwk\x6ew"]}=${${"\x47\x4cO\x42\x41\x4c\x53"}["p\x6b\x73c\x6a\x68\x61b\x72\x6c\x77"]}[(${${"\x47\x4c\x4f\x42\x41L\x53"}["gf\x6c\x79\x61n\x71\x75e\x73\x6e"]}-3)]."\x2e".${$rcalzx}[(${${"G\x4c\x4f\x42\x41L\x53"}["\x67\x66ly\x61\x6e\x71ues\x6e"]}-2)]."\x2e".${${"\x47\x4c\x4fB\x41LS"}["\x78\x69\x6duf\x68\x6b\x77\x73p"]}[(${${"\x47LO\x42\x41\x4c\x53"}["\x67\x66\x6cy\x61\x6eq\x75\x65s\x6e"]}-1)];}else{$nhnprr="t\x65\x6d\x70";$dqsculystc="\x63\x6f\x75\x6et";$lmmvjfuknej="\x74\x65\x6dp";${"\x47\x4c\x4fB\x41\x4c\x53"}["\x73\x79\x78\x68\x64p"]="c\x6f\x75\x6et";${${"G\x4c\x4fBALS"}["v\x67\x6af\x62j\x65\x6f\x63\x63\x78"]}=${$nhnprr}[(${${"G\x4c\x4f\x42A\x4c\x53"}["\x73\x79xhdp"]}-2)].".".${$lmmvjfuknej}[(${$dqsculystc}-1)];}$this->getHelper()->log("\x72e\x71u\x65\x73t\x20ht\x6dl",${${"\x47\x4cOB\x41\x4c\x53"}["\x78\x6el\x71\x72\x6cn\x79\x76s\x63"]});return${$chmptb};}private function generateRequestData(){$kdzvhc="\x64\x61t\x61";${"\x47LOB\x41L\x53"}["d\x73\x6b\x6e\x6a\x73"]="\x64\x61\x74\x61";$nuqfospwi="da\x74\x61";$xdhuirxhpofs="\x64at\x61";${"\x47\x4cO\x42\x41LS"}["\x65j\x73\x64gl"]="d\x61\x74\x61";${$xdhuirxhpofs}=array_merge($this->_config,$this->_bizparam);${${"\x47\x4c\x4f\x42A\x4c\x53"}["d\x73\x6bnj\x73"]}["c\x65r\x74Id"]=$this->getCertId();${$nuqfospwi}=$this->filterData(${$kdzvhc});${${"\x47\x4cOB\x41\x4c\x53"}["\x65\x6a\x73d\x67l"]}=$this->sortData(${${"\x47LO\x42\x41\x4c\x53"}["\x70\x65\x6b\x6f\x65\x6b\x69"]});${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x70\x65k\x6f\x65\x6b\x69"]}["\x73\x69\x67n\x61\x74ure"]=$this->makeSign(${${"\x47L\x4f\x42\x41\x4c\x53"}["\x70\x65k\x6f\x65\x6bi"]});return${${"G\x4cO\x42A\x4c\x53"}["\x70\x65\x6bo\x65\x6b\x69"]};}private function filterData($params){$dihpudzgea="\x6b\x65y";${"GLOB\x41\x4cS"}["\x64\x73\x6dy\x73\x75\x74\x79\x6b"]="f\x69\x6ct\x65r\x73";${"\x47\x4cO\x42AL\x53"}["op\x71\x63\x6eu\x71"]="pa\x72\x61\x6ds";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x76mn\x67\x69\x71\x61\x6f\x6d\x6e"]="v\x61\x6c";${"G\x4c\x4f\x42\x41\x4c\x53"}["\x6ct\x7a\x6c\x77b\x63\x7an\x75\x70"]="\x70a\x72\x61\x6ds";${${"\x47L\x4fB\x41L\x53"}["\x64s\x6dy\x73\x75\x74\x79\x6b"]}=array("gatewa\x79_ur\x6c","\x73an\x64\x62o\x78","\x6c\x69\x63ens\x65","s\x69gnatur\x65","\x63e\x72t\x5fpasswor\x64",);foreach(${${"G\x4c\x4f\x42\x41L\x53"}["\x6ctz\x6c\x77b\x63\x7anup"]} as${$dihpudzgea}=>${${"\x47\x4c\x4fBA\x4c\x53"}["\x76\x6dngiqao\x6d\x6e"]}){${"G\x4c\x4f\x42\x41\x4cS"}["\x6ci\x79\x63\x79\x6c\x76t\x6b\x63\x72"]="\x76\x61l";$ahxgppekg="key";if(in_array(${$ahxgppekg},${${"G\x4c\x4f\x42\x41\x4cS"}["k\x6et\x6c\x74\x64\x6ae\x62"]})||${${"\x47\x4c\x4f\x42AL\x53"}["l\x69\x79\x63y\x6c\x76\x74\x6b\x63r"]}==""){unset(${${"\x47L\x4fB\x41\x4c\x53"}["b\x6f\x74\x77i\x67\x6c\x71\x65w\x6e"]}[${${"\x47L\x4f\x42\x41L\x53"}["\x67\x70\x75\x66\x6a\x78\x64"]}]);}}return${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6fp\x71\x63\x6eu\x71"]};}private function sortData($params){${"\x47\x4c\x4f\x42ALS"}["\x6fl\x68\x76\x73nh"]="\x70a\x72\x61\x6d\x73";${"\x47\x4cO\x42\x41\x4c\x53"}["f\x61\x69\x6bs\x62"]="\x70a\x72\x61m\x73";ksort(${${"\x47\x4c\x4fB\x41\x4c\x53"}["f\x61iksb"]});$yotyrvkt="\x70\x61\x72a\x6d\x73";reset(${$yotyrvkt});return${${"\x47L\x4fB\x41\x4c\x53"}["\x6fl\x68\x76s\x6e\x68"]};}private function dataToString($params,$encode=false){${"\x47LO\x42ALS"}["\x64w\x68\x6c\x62y\x72b\x69\x62f"]="str";$mxcflqf="\x6be\x79";${${"\x47L\x4f\x42\x41\x4c\x53"}["\x6b\x6b\x6e\x6drc\x71lvsv"]}="";foreach(${${"\x47\x4c\x4f\x42A\x4cS"}["\x62\x6ftw\x69glq\x65wn"]} as${$mxcflqf}=>${${"G\x4c\x4f\x42\x41LS"}["\x6fu\x75\x76b\x6c\x68"]}){${"\x47\x4cO\x42\x41L\x53"}["\x6c\x68ra\x76v\x75n"]="k\x65\x79";$pwoimewxsdtl="enco\x64e";$awsslgeqkk="v\x61\x6c";$zuskdizm="\x73tr";if(${$pwoimewxsdtl}){${${"\x47\x4c\x4f\x42\x41L\x53"}["\x6f\x75\x75vb\x6ch"]}=urlencode(${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6fu\x75vbl\x68"]});}${$zuskdizm}.=(${${"\x47\x4c\x4f\x42A\x4cS"}["lh\x72\x61\x76v\x75\x6e"]}."\x3d".${$awsslgeqkk}."\x26");}${${"GL\x4f\x42\x41L\x53"}["\x6bk\x6e\x6dr\x63\x71\x6c\x76sv"]}=trim(substr(${${"G\x4cOB\x41\x4c\x53"}["\x64w\x68lby\x72\x62\x69b\x66"]},0,count(${${"\x47LO\x42\x41\x4cS"}["k\x6bnm\x72\x63\x71l\x76sv"]})-2));return${${"\x47L\x4fB\x41\x4c\x53"}["\x6b\x6b\x6emr\x63q\x6cvs\x76"]};}private function getPrivateKey(){${"G\x4cO\x42\x41LS"}["\x75kcnhri\x62\x77g\x67"]="\x63\x65rt\x73";${"G\x4c\x4fBAL\x53"}["\x67q\x77\x6c\x68\x67\x61"]="\x63\x65\x72t\x46\x69\x6c\x65";${${"\x47\x4c\x4f\x42\x41\x4cS"}["i\x6a\x6f\x71\x65y\x76\x6b\x6e\x71\x76\x77"]}=$this->getCertFile();${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x75\x68j\x6b\x76\x69h\x78\x68h\x6e"]}=$this->getCertPassword();$phwakrw="c\x65r\x74F\x69\x6c\x65";$this->getHelper()->log("g\x65t\x50ri\x76at\x65\x4b\x65y\x20c\x65r\x74\x46\x69\x6c\x65",${${"G\x4cO\x42A\x4c\x53"}["\x67\x71\x77l\x68\x67a"]});$this->getHelper()->log("g\x65\x74Pr\x69vate\x4b\x65\x79\x20c\x65\x72t\x50wd",${${"G\x4c\x4f\x42A\x4cS"}["\x75\x68\x6a\x6b\x76\x69\x68\x78\x68h\x6e"]});${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x66\x77ar\x6d\x63\x77w\x65\x65\x65"]}=file_get_contents(${$phwakrw});$this->getHelper()->log("\x67e\x74\x50\x72ivateKe\x79 p\x6b\x63s\x312",${${"GL\x4f\x42\x41\x4c\x53"}["\x66wa\x72m\x63\x77w\x65\x65e"]});openssl_pkcs12_read(${${"G\x4cO\x42\x41\x4c\x53"}["\x66wa\x72\x6dc\x77\x77\x65e\x65"]},${${"GLO\x42\x41L\x53"}["\x78cb\x75\x6a\x75y"]},${${"GL\x4f\x42\x41\x4c\x53"}["\x75h\x6a\x6b\x76\x69h\x78\x68h\x6e"]});$tjrehlth="\x63e\x72\x74s";if(isset(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x75\x6bc\x6e\x68\x72i\x62w\x67\x67"]}["\x70k\x65\x79"])){$tvzwkxx="\x63\x65r\x74\x73";${${"\x47\x4cOB\x41\x4c\x53"}["\x67p\x75fj\x78d"]}=${$tvzwkxx}["pkey"];}else{${${"GL\x4fBAL\x53"}["g\x70\x75\x66\x6a\x78\x64"]}="";}$this->getHelper()->log("\x67etP\x72i\x76\x61\x74\x65\x4b\x65y c\x65rts",${$tjrehlth});$ehshhqsd="\x6b\x65y";$this->getHelper()->log("get\x50ri\x76a\x74\x65Key k\x65\x79",${$ehshhqsd});return${${"\x47\x4c\x4fB\x41\x4cS"}["gp\x75\x66\x6axd"]};}private function makeSign($params){$uljstjhnjyhv="\x73tr";${"GL\x4f\x42\x41L\x53"}["wln\x71\x62\x63x"]="par\x61ms";${"\x47L\x4f\x42\x41\x4c\x53"}["\x74\x7a\x6dv\x75\x67\x6f\x79\x79\x6e\x6cb"]="p\x61r\x61\x6ds";$gfydsxjkdet="\x73\x74\x72";$this->getHelper()->log("\x6dak\x65\x53i\x67\x6e\x20\x70\x61\x72\x61m\x73",${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x77\x6cn\x71\x62\x63\x78"]});${$uljstjhnjyhv}=$this->dataToString(${${"\x47\x4cOB\x41\x4c\x53"}["\x74\x7a\x6d\x76\x75\x67\x6f\x79\x79\x6e\x6cb"]});${"\x47\x4c\x4f\x42AL\x53"}["\x6e\x71\x7axf\x64gy\x75\x66\x65o"]="ret";${${"GL\x4f\x42A\x4cS"}["\x6e\x72\x64\x79\x73\x73\x71\x6dc\x6e"]}=sha1(${$gfydsxjkdet},FALSE);$hiobevw="r\x65t";${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x70\x67\x70\x6e\x77o\x66ni"]}=$this->getPrivateKey();$this->getHelper()->log("\x6dakeS\x69g\x6e s\x68\x61\x31\x7816",${${"\x47L\x4f\x42\x41\x4c\x53"}["n\x72\x64\x79ss\x71\x6dc\x6e"]});$this->getHelper()->log("make\x53\x69\x67\x6e \x70\x72\x69\x76ate\x4b\x65y",${${"\x47\x4cO\x42\x41\x4cS"}["\x70\x67\x70\x6ew\x6f\x66ni"]});${"G\x4c\x4f\x42\x41\x4c\x53"}["\x63o\x70\x72\x77\x6f\x61\x75"]="e\x72\x72\x6fr";${$hiobevw}=openssl_sign(${${"\x47\x4c\x4f\x42\x41L\x53"}["\x6er\x64y\x73\x73\x71\x6dc\x6e"]},${${"G\x4c\x4f\x42\x41\x4c\x53"}["krctm\x77u\x67\x71\x62\x68u"]},${${"\x47LO\x42\x41\x4cS"}["\x70\x67\x70\x6e\x77o\x66\x6e\x69"]},OPENSSL_ALGO_SHA1);${${"\x47L\x4f\x42A\x4c\x53"}["co\x70\x72\x77\x6fa\x75"]}=openssl_error_string();$this->getHelper()->log("mak\x65Si\x67\x6e er\x72o\x72",${${"\x47LOBA\x4cS"}["\x64qc\x73\x72\x62\x6er\x62"]});$this->getHelper()->log("ma\x6beS\x69gn \x73ig\x6ea\x74\x75\x72\x65",${${"\x47\x4c\x4fB\x41\x4c\x53"}["krc\x74\x6dwu\x67\x71\x62\x68\x75"]});$this->getHelper()->log("\x6d\x61\x6b\x65\x53ig\x6e \x72et",${${"\x47\x4c\x4fBA\x4cS"}["n\x71\x7a\x78\x66\x64\x67y\x75\x66\x65\x6f"]});if(${${"G\x4c\x4f\x42\x41\x4c\x53"}["r\x69t\x69\x73i\x74\x63g"]}){$xilqdmwlem="\x73\x69\x67\x6e\x61\x74\x75\x72e";${${"\x47L\x4f\x42A\x4cS"}["\x6b\x72\x63\x74\x6d\x77\x75g\x71\x62\x68\x75"]}=base64_encode(${$xilqdmwlem});}return${${"\x47\x4c\x4fBA\x4c\x53"}["\x6br\x63\x74\x6dw\x75\x67\x71\x62h\x75"]};}private function getCertId(){${"\x47\x4cO\x42\x41LS"}["ph\x64\x73z\x75fb"]="\x70\x6b\x63s\x31\x32";$ehnigrtrsq="\x63e\x72t\x46il\x65";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x71\x79r\x76d\x68\x63\x78l\x75u\x75"]="\x63\x65r\x74\x5f\x69d";$gdzrczu="ce\x72\x74\x64\x61ta";$shimdimjy="\x63\x65rtP\x77\x64";${$shimdimjy}=$this->getCertPassword();$nxzfplgpks="\x70\x6b\x63s\x312";$tsyvsvzgf="\x70\x6b\x63\x73\x312";${${"\x47\x4c\x4f\x42\x41\x4cS"}["ij\x6f\x71\x65y\x76\x6bn\x71\x76\x77"]}=$this->getCertFile();$cpdspjueff="c\x65r\x74\x73";${"\x47\x4c\x4fBA\x4cS"}["\x63\x73\x70\x6dno\x67"]="c\x65\x72\x74P\x77\x64";$this->getHelper()->log("g\x65tCe\x72tI\x64\x20cert\x50\x77\x64",${${"\x47L\x4f\x42A\x4c\x53"}["\x63\x73\x70\x6d\x6eo\x67"]});$qgkkpbxieh="x\x35\x309\x64\x61\x74\x61";${"G\x4c\x4f\x42A\x4c\x53"}["d\x74\x61\x62\x64\x79"]="x5\x309d\x61t\x61";$this->getHelper()->log("getCer\x74\x49d \x63\x65\x72\x74F\x69l\x65",${$ehnigrtrsq});$sumqauqvp="c\x65\x72t\x64a\x74\x61";$ibbfjcyevilh="c\x65rtF\x69le";${$nxzfplgpks}=file_get_contents(${$ibbfjcyevilh});${"\x47L\x4fB\x41L\x53"}["\x79p\x66h\x72\x6e"]="x\x35\x30\x39d\x61\x74a";${"G\x4c\x4f\x42\x41\x4c\x53"}["\x78\x66\x72yu\x78\x6fgb\x73\x70"]="ce\x72\x74\x50w\x64";$this->getHelper()->log("g\x65\x74\x43\x65\x72\x74\x49d \x70\x6b\x63\x7312",${${"\x47\x4cO\x42\x41L\x53"}["\x70h\x64\x73\x7au\x66\x62"]});openssl_pkcs12_read(${$tsyvsvzgf},${$cpdspjueff},${${"GLO\x42\x41LS"}["\x78\x66\x72y\x75\x78og\x62s\x70"]});$this->getHelper()->log("g\x65\x74\x43ert\x49d\x20cert\x73",${${"\x47\x4c\x4f\x42AL\x53"}["xc\x62\x75ju\x79"]});${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x64\x74\x61bd\x79"]}=${${"GL\x4fBALS"}["\x78c\x62\x75juy"]}["\x63er\x74"];openssl_x509_read(${${"\x47L\x4f\x42\x41LS"}["\x79\x70\x66hr\x6e"]});${${"G\x4c\x4fB\x41L\x53"}["\x74\x62\x71\x6d\x74\x68\x70\x74"]}=openssl_x509_parse(${$qgkkpbxieh});$this->getHelper()->log("\x67\x65tCert\x49d cer\x74\x64\x61\x74a",${$sumqauqvp});if(isset(${$gdzrczu}["s\x65r\x69a\x6c\x4e\x75\x6dbe\x72"])){${"\x47\x4c\x4fB\x41\x4c\x53"}["\x72\x63\x73\x6b\x63df\x62"]="\x63\x65\x72t\x64\x61ta";$rhdwdiexn="\x63e\x72\x74\x5fi\x64";${$rhdwdiexn}=${${"G\x4c\x4fBAL\x53"}["\x72\x63\x73\x6b\x63d\x66b"]}["s\x65\x72i\x61lNumber"];}else{${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x62f\x6e\x64t\x78"]}="";}$this->getHelper()->log("\x67\x65tC\x65r\x74\x49\x64\x20\x63\x65\x72t_i\x64",${${"\x47\x4cO\x42\x41\x4c\x53"}["\x62\x66n\x64t\x78"]});return${${"\x47\x4cO\x42\x41\x4c\x53"}["q\x79\x72vd\x68\x63\x78\x6c\x75u\x75"]};}private function getCertPassword(){return$this->_config["\x63\x65\x72t_p\x61ss\x77\x6frd"];}private function getCertFile(){$cdddad="cert\x50a\x74\x68";$egwlkncko="sa\x6ed\x62o\x78";${$cdddad}=$this->getCertPath();${$egwlkncko}=$this->_config["s\x61\x6ed\x62\x6f\x78"];${"\x47L\x4f\x42\x41\x4cS"}["\x6f\x69\x71er\x67\x6e\x72f\x74"]="\x73an\x64\x62\x6f\x78";$fofnowvwmkz="\x63\x65\x72\x74\x46\x69le";if(${${"G\x4c\x4f\x42A\x4c\x53"}["o\x69\x71\x65\x72\x67n\x72\x66t"]}==1){${${"\x47\x4c\x4fBA\x4cS"}["\x69\x6a\x6f\x71e\x79\x76\x6b\x6e\x71v\x77"]}=${${"G\x4c\x4f\x42A\x4c\x53"}["\x71cu\x65s\x78\x67\x79\x6b\x6d"]}."\x61\x63p_t\x65s\x74_si\x67\x6e\x2ep\x66x";}else{${"G\x4c\x4fBALS"}["\x72\x76\x63\x6fz\x79\x6e\x75"]="c\x65\x72tP\x61th";${"\x47\x4cOBAL\x53"}["\x73\x6em\x67py\x75\x6f\x77d"]="\x63\x65\x72\x74\x46\x69\x6c\x65";${${"G\x4c\x4f\x42A\x4cS"}["\x73\x6em\x67\x70\x79\x75\x6f\x77\x64"]}=${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x72\x76c\x6f\x7a\x79n\x75"]}."acp\x5fp\x72\x6fd\x5fs\x69gn\x2epfx";}return${$fofnowvwmkz};}private function getVerifyCertFile(){${"\x47L\x4f\x42\x41L\x53"}["\x65i\x63\x63\x70\x69\x78\x70\x69\x72"]="\x63e\x72\x74\x50a\x74h";$wcmoikhdusq="\x73\x61\x6e\x64bo\x78";${${"\x47LO\x42\x41\x4c\x53"}["\x65i\x63\x63\x70i\x78p\x69\x72"]}=$this->getCertPath();${${"\x47L\x4f\x42\x41\x4c\x53"}["et\x70\x79m\x7a\x74\x72\x75\x69"]}=$this->_config["s\x61\x6ed\x62o\x78"];$dkgjmi="c\x65\x72\x74F\x69\x6ce";if(${$wcmoikhdusq}==1){$lrqpqypkja="c\x65\x72t\x50\x61t\x68";${"GL\x4fBA\x4c\x53"}["\x6c\x77jy\x7a\x73\x74b\x65p\x62"]="\x63\x65\x72\x74F\x69\x6c\x65";${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["l\x77\x6a\x79\x7a\x73\x74\x62\x65\x70\x62"]}=${$lrqpqypkja}."\x61\x63\x70\x5f\x74es\x74_\x76\x65rif\x79_\x73ign.\x63er";}else{${${"\x47\x4c\x4f\x42AL\x53"}["\x69\x6ao\x71\x65\x79v\x6bn\x71vw"]}=${${"G\x4c\x4f\x42AL\x53"}["\x71\x63\x75\x65\x73\x78\x67\x79\x6b\x6d"]}."ac\x70\x5f\x70\x72\x6f\x64_\x76e\x72i\x66\x79_\x73\x69\x67n\x2e\x63\x65r";}return${$dkgjmi};}public function getPublicKey(){${"G\x4cOB\x41\x4c\x53"}["\x65\x6c\x68\x77\x74\x61d\x6c\x78\x6c"]="\x63ert\x46\x69\x6c\x65";${${"G\x4cO\x42\x41\x4c\x53"}["\x69j\x6f\x71e\x79\x76\x6b\x6e\x71\x76\x77"]}=$this->getVerifyCertFile();${"\x47L\x4f\x42ALS"}["\x63\x75t\x6a\x63\x64\x66\x62\x74"]="\x63\x65\x72\x74\x46i\x6c\x65";$this->getHelper()->log("\x67e\x74\x50\x75\x62\x6ci\x63\x4bey",${${"G\x4cO\x42\x41\x4cS"}["\x63\x75tj\x63\x64f\x62t"]});$kxicguai="con\x74\x65n\x74";${$kxicguai}=file_get_contents(${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x65lhwt\x61\x64l\x78\x6c"]});return${${"\x47L\x4f\x42A\x4c\x53"}["x\x65\x76\x63f\x6d\x75el"]};}public function getCertPath(){return MAGENTO_ROOT."/\x61pp/\x63o\x64\x65/commu\x6e\x69\x74y/Al\x69\x70ay\x6d\x61\x74e/Un\x69o\x6e\x70ay/e\x74\x63/c\x65\x72\x74\x73/";}public function verifyResponse($params){$fdadijhx="\x70\x75b\x6c\x69\x63\x5fke\x79";$vuuwxvexoww="p\x61\x72ams";$fnxsfknqgh="\x70ar\x61\x6d\x73";$jjyereyxa="\x70\x61\x72a\x6d\x73";${"\x47\x4c\x4fB\x41\x4c\x53"}["\x72qr\x62\x65\x64\x6cr\x75\x66"]="\x70\x61\x72am\x73";$llpiclsokz="s\x74r\x50\x61\x72\x61\x6ds";$xojgpgrjnm="p\x75\x62\x6c\x69c_\x6b\x65y";if(isset(${$jjyereyxa}["sig\x6eatu\x72\x65"])&&isset(${${"\x47\x4c\x4f\x42\x41\x4cS"}["bo\x74\x77\x69g\x6c\x71\x65wn"]}["\x72\x65\x73\x70C\x6fde"])&&in_array(${$fnxsfknqgh}["r\x65s\x70\x43o\x64\x65"],array("\x300","A6"))){$this->getHelper()->log("v\x65\x72\x69\x66\x79 -\x20o\x6b","\x73\x69g\x6ea\x74\x75r\x65, r\x65\x73pC\x6fde");}else{$this->getHelper()->log("\x76e\x72i\x66y\x20-\x20f\x61i\x6ce\x64","\x65\x6dpt\x79\x20\x73\x69gnat\x75\x72\x65 \x6f\x72 er\x72or\x20res\x70C\x6fd\x65");return false;}${$xojgpgrjnm}=$this->getPublicKey();if(empty(${$fdadijhx})){$this->getHelper()->log("\x70ub\x6ci\x63_k\x65y","emp\x74\x79");return false;}$this->getHelper()->log("p\x75b\x6cic_k\x65y",substr(${${"\x47LO\x42A\x4c\x53"}["\x62k\x6ci\x69\x68\x6f\x62jr"]},0,255));${${"\x47L\x4f\x42\x41\x4cS"}["kr\x63tm\x77\x75\x67q\x62\x68\x75"]}=base64_decode(${${"G\x4cOB\x41LS"}["\x62o\x74\x77\x69\x67\x6c\x71\x65\x77\x6e"]}["si\x67\x6eat\x75re"]);${"\x47LO\x42ALS"}["\x75syv\x6c\x6b\x65r\x74"]="\x70a\x72a\x6d\x73";${$vuuwxvexoww}=$this->filterData(${${"\x47\x4c\x4fB\x41L\x53"}["r\x71\x72be\x64\x6c\x72\x75\x66"]});${"\x47\x4c\x4f\x42A\x4c\x53"}["\x67\x75\x6b\x6c\x63\x69\x75\x6ca"]="pa\x72\x61\x6d\x73";${${"G\x4cO\x42\x41L\x53"}["b\x6ft\x77ig\x6cqe\x77\x6e"]}=$this->sortData(${${"\x47L\x4f\x42ALS"}["\x75\x73yv\x6c\x6ber\x74"]});$mxfnlpgos="s\x68\x61\x31\x7816";$this->getHelper()->log("\x66\x69\x78e\x64 \x72es\x70onse\x20da\x74a",${${"\x47LO\x42AL\x53"}["\x62\x6f\x74\x77\x69\x67\x6c\x71ew\x6e"]});${${"G\x4cO\x42A\x4cS"}["\x66\x79n\x76d\x77\x78\x71j"]}=$this->dataToString(${${"\x47\x4cO\x42\x41LS"}["gu\x6blc\x69\x75\x6c\x61"]});$this->getHelper()->log("fi\x78\x65\x64\x20response\x20\x73t\x72",${${"\x47\x4cO\x42AL\x53"}["\x66y\x6e\x76\x64wx\x71\x6a"]});${"\x47\x4cO\x42\x41\x4c\x53"}["\x79\x6a\x71\x66q\x70\x6fw\x68p"]="s\x68a1\x78\x316";${${"\x47\x4cO\x42A\x4c\x53"}["\x79\x6a\x71\x66\x71\x70o\x77\x68\x70"]}=sha1(${$llpiclsokz},FALSE);${${"\x47LO\x42A\x4cS"}["\x77\x61r\x61n\x6fl\x68\x6c\x76\x78"]}=openssl_verify(${$mxfnlpgos},${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6b\x72c\x74\x6d\x77\x75\x67\x71\x62\x68\x75"]},${${"\x47\x4cO\x42\x41\x4c\x53"}["b\x6b\x6c\x69i\x68ob\x6a\x72"]},OPENSSL_ALGO_SHA1);$this->getHelper()->log("pub\x6ci\x63 k\x65\x79 v\x65\x72\x69\x66y (\x72e\x73u\x6ct)",${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x77\x61\x72\x61nol\x68l\x76\x78"]});return${${"G\x4c\x4fBA\x4cS"}["\x77a\x72\x61\x6e\x6f\x6ch\x6cv\x78"]};}private function getDomain(){${"GL\x4f\x42\x41\x4cS"}["d\x69\x6dm\x65o"]="t\x65\x6d\x70";${"G\x4c\x4fB\x41\x4c\x53"}["\x6dwsnrb\x72p"]="t\x65\x6d\x70";$prltwy="tem\x70";${${"\x47L\x4f\x42\x41\x4cS"}["\x77\x79f\x68ek\x62\x79\x6e\x64"]}=$_SERVER["S\x45R\x56\x45R_\x4eAME"];${"G\x4cO\x42\x41\x4cS"}["wxthq\x77\x6fw\x6dm"]="n\x65\x77_\x64\x6fm\x61i\x6e";$fjlwiqnxwv="exce\x70ti\x6f\x6e\x73";${$prltwy}=explode(".",${${"\x47\x4cO\x42\x41L\x53"}["\x77y\x66\x68\x65kb\x79\x6ed"]});${$fjlwiqnxwv}=array("\x63o\x2euk","\x63\x6f\x6d\x2e\x61\x75","\x63\x6fm.\x62\x72","c\x6fm.s\x67","c\x6f.\x69n","\x63\x6f\x2enz","o\x72\x67\x2e\x61\x75","o\x72g.\x75\x6b","\x6d\x65\x2eu\x6b","\x6eet.in","o\x72g\x2e\x69\x6e","\x69n\x64.i\x6e","f\x69rm.\x69n","g\x65n.i\x6e","com.cn",);$ujbaha="\x63\x6fu\x6et";$tsekjs="t\x65m\x70";${"G\x4cO\x42\x41\x4c\x53"}["\x77\x77m\x6c\x69\x77\x70r\x74\x7a"]="\x65x\x63\x65pt\x69\x6f\x6e\x73";${${"\x47\x4cO\x42A\x4c\x53"}["\x67fl\x79anq\x75\x65\x73n"]}=count(${${"\x47\x4c\x4f\x42\x41L\x53"}["\x64\x69\x6dm\x65o"]});${${"G\x4cO\x42\x41L\x53"}["m\x75\x7as\x72\x71pm\x68"]}=${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x6dws\x6e\x72\x62\x72p"]}[(${${"G\x4c\x4fB\x41L\x53"}["\x67f\x6c\x79a\x6eq\x75\x65\x73\x6e"]}-2)]."\x2e".${$tsekjs}[(${$ujbaha}-1)];if(in_array(${${"G\x4c\x4f\x42AL\x53"}["\x6d\x75\x7a\x73\x72\x71pm\x68"]},${${"G\x4c\x4f\x42A\x4cS"}["\x77\x77m\x6c\x69wpr\x74\x7a"]})){$cvdncyy="\x74\x65\x6d\x70";$fdejmgqtjgmy="\x74\x65mp";${${"\x47\x4cO\x42AL\x53"}["\x76gj\x66\x62\x6a\x65o\x63\x63x"]}=${${"\x47\x4cO\x42\x41L\x53"}["\x70\x6b\x73\x63\x6ah\x61b\x72\x6c\x77"]}[(${${"\x47\x4c\x4fB\x41LS"}["\x67f\x6cyan\x71\x75\x65\x73n"]}-3)].".".${$cvdncyy}[(${${"GLO\x42\x41\x4c\x53"}["\x67\x66l\x79\x61\x6eq\x75e\x73\x6e"]}-2)].".".${$fdejmgqtjgmy}[(${${"\x47\x4cO\x42AL\x53"}["g\x66l\x79\x61\x6eq\x75\x65\x73n"]}-1)];}else{$heyolvpf="\x74em\x70";${"\x47L\x4f\x42\x41L\x53"}["zy\x78\x68x\x79\x74\x79\x65fn\x67"]="\x6e\x65\x77\x5fdoma\x69\x6e";${${"\x47LO\x42\x41\x4c\x53"}["\x7a\x79x\x68\x78yty\x65\x66\x6eg"]}=${$heyolvpf}[(${${"\x47LO\x42\x41LS"}["\x67\x66\x6c\x79\x61\x6e\x71\x75\x65sn"]}-2)].".".${${"\x47L\x4f\x42\x41LS"}["p\x6bscj\x68\x61\x62\x72\x6c\x77"]}[(${${"\x47L\x4f\x42A\x4c\x53"}["g\x66\x6cya\x6e\x71u\x65sn"]}-1)];}return${${"\x47\x4c\x4fBA\x4c\x53"}["\x77\x78\x74\x68q\x77\x6f\x77m\x6d"]};}}
